ORG 00H
;MOV SP,#70H
;MOV PSW,#00H
RS EQU P2.0
RW EQU P2.1
ENBL EQU P2.2
CLR P3.7
MOV P1,#0FFH
MOV A,#38H
LCALL COMMAND
LCALL DELAY
MOV A,#0EH
LCALL COMMAND
LCALL DELAY
MOV A,#01H
LCALL COMMAND
LCALL DELAY
MOV A,#06H
LCALL COMMAND
LCALL DELAY
MOV A,#80H
LCALL COMMAND
LCALL DELAY
START:
MOV R0,#30H
MOV R1,#40H
MOV R3,#3
MOV R4,#6
MOV A,#01H
ACALL COMMAND
ACALL DELAY
MOV DPTR,#MSG_1
LOOP_1:
CLR A
MOVC A,@A+DPTR
JZ K0
LCALL DISPLAY
LCALL DELAY
INC DPTR
LJMP LOOP_1
K0:
MOV A,#0C0H
LCALL COMMAND
LCALL DELAY
MOV DPTR,#MSG_4
LOOP_4:
CLR A
MOVC A,@A+DPTR
JZ KK0

LCALL DISPLAY
LCALL DELAY
INC DPTR
LJMP LOOP_4
KK0:
MOV A,#89H
LCALL COMMAND
LCALL DELAY
K1:
CLR P2.4
CLR P2.5
CLR P2.6
CLR P2.7
MOV A,P3
ANL A,#00001111B
CJNE A,#00001111B,K1
K2:
ACALL DELAY
MOV A,P3
ANL A,#00001111B
CJNE A,#00001111B,OVER
SJMP K2
OVER:
ACALL DELAY
MOV A,P3
ANL A,#00001111B
CJNE A,#00001111B,OVER1
SJMP K2
OVER1:
CLR P2.4
SETB P2.5
SETB P2.6
SETB P2.7
MOV A,P3
ANL A,#00001111B
CJNE A,#00001111B,ROW_0
SETB P2.4
CLR P2.5
SETB P2.6
SETB P2.7
MOV A,P3
ANL A,#00001111B
CJNE A,#00001111B,ROW_1
SETB P2.4
SETB P2.5
CLR P2.6
SETB P2.7
MOV A,P3
ANL A,#00001111B
CJNE A,#00001111B,ROW_2
SETB P2.4
SETB P2.5
SETB P2.6
CLR P2.7
MOV A,P3
ANL A,#00001111B
CJNE A,#00001111B,ROW_3
LJMP K2

ROW_0: MOV DPTR,#KCODE0
SJMP FIND
ROW_1: MOV DPTR,#KCODE1
SJMP FIND
ROW_2: MOV DPTR,#KCODE2
SJMP FIND
ROW_3: MOV DPTR,#KCODE3
SJMP FIND
FIND:
RRC A
JNC MATCH
INC DPTR
SJMP FIND
MATCH:
MOV A,R3
JZ PSWRD
CLR A
MOVC A,@A+DPTR
LCALL DISPLAY
MOV @R0,A
INC R0
DEC R3
CJNE R3,#0,A1
SJMP A2
A1:
LJMP K1
A2:
MOV A,#0C9H
LCALL COMMAND

SJMP A1

PSWRD:
CLR A
MOVC A,@A+DPTR
LCALL DISPLAY

LCALL DELAY
MOV @R1,A
INC R1
DEC R4
CJNE R4,#0,NEXT
SJMP HERE

NEXT: LJMP K1
HERE:
MOV R3,#3
MOV R0,#30H
MOV DPTR,#USERNAME
CALC:
MOV A,@R0
MOV B,A
CLR A
MOVC A,@A+DPTR
CJNE A,B,DENIED
INC R0
INC DPTR
DJNZ R3,CALC
SJMP GRANTED
DENIED:
MOV A,#01H
ACALL COMMAND
ACALL DELAY
MOV DPTR,#MSG_2
LOOP_2:
CLR A
MOVC A,@A+DPTR
JZ RESTART
LCALL DISPLAY
LCALL DELAY
INC DPTR
LJMP LOOP_2
RESTART:
ACALL DELAY_1
ACALL DELAY_1
LJMP START

GRANTED:
MOV R4,#6
;INITIALISATION FOR PASSWORD
MOV R1,#40H
MOV DPTR,#PASSWORD
CALC1:
MOV A,@R1
MOV B,A
CLR A
MOVC A,@A+DPTR
CJNE A,B,DENIED
INC R1
INC DPTR
DJNZ R4,CALC1
MOV A,#01H
ACALL COMMAND
ACALL DELAY
MOV DPTR,#MSG_3
SETB P3.7
LOOP_3:
CLR A
MOVC A,@A+DPTR
JZ FINISH
LCALL DISPLAY
LCALL DELAY
INC DPTR
LJMP LOOP_3
FINISH:
SJMP $
COMMAND:
LCALL READY
MOV P1,A
CLR RS
CLR RW
SETB ENBL
LCALL DELAY
CLR ENBL
RET
DISPLAY:
LCALL READY
MOV P1,A
SETB RS
CLR RW
SETB ENBL
LCALL DELAY
CLR ENBL
RET
READY:
SETB P1.7
CLR RS
SETB RW
WAIT:
CLR ENBL
ACALL DELAY
SETB ENBL

JB P1.7,WAIT
RET

DELAY:
MOV R5,#50
AGAIN_2:
MOV R6,#200
AGAIN:
DJNZ R6,AGAIN
DJNZ R5,AGAIN_2
RET

DELAY_1:
MOV R5, #20
AGAN_2:
MOV R6, #110
AGAN_1:
MOV R7, #150
AGAN:
DJNZ R7, AGAN
DJNZ R6, AGAN_1
DJNZ R5, AGAN_2
RET

USERNAME: DB 'B','A','D'
PASSWORD: DB '1','1','1','0','2','2'
MSG_1: DB "USERNAME:",0
MSG_2: DB "ACCESS DENIED..",0
MSG_3: DB "ACCESS GRANTED!!",0
MSG_4: DB "PASSWORD:",0

ORG 300H
KCODE2: DB '1','2','3','A'
KCODE1: DB '4','5','6','B'
KCODE0: DB '7','8','9','C'
KCODE3: DB '*','0','#','D'
END